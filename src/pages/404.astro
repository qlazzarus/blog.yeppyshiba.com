---
import { getCollection } from 'astro:content';
import BaseLayout from '@/layouts/BaseLayout.astro';
import EntryGrid from '@/components/EntryGrid.astro';

const pathname = Astro.url.pathname;

// 최신 글 6개(없으면 빈 배열)
const posts = (await getCollection('blog'))
    .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
    .slice(0, 6);

const title = '404 — 페이지를 찾을 수 없어요';
const description = `요청하신 경로(${pathname})에 해당하는 페이지가 존재하지 않습니다.`;
---

<BaseLayout title={title} description={description}>
    <section class='mx-auto max-w-3xl'>
        <div class='bg-card rounded-xl border p-6 shadow-sm'>
            <div class='flex flex-col gap-3'>
                <div class='text-muted-foreground text-sm'>Not Found</div>
                <h1 class='text-3xl font-bold tracking-tight'>404</h1>
                <p class='text-muted-foreground'>
                    요청하신 페이지를 찾을 수 없어요. 주소가 변경되었거나 삭제되었을 수
                    있습니다.
                </p>

                <div class='text-muted-foreground mt-4 text-xs'>
                    요청 경로: <code class='bg-muted rounded px-1 py-0.5'
                        >{pathname}</code
                    >
                </div>
            </div>
        </div>

        {
            posts.length > 0 && (
                <div class='mt-10'>
                    <div class='mb-4 flex items-end justify-between'>
                        <h2 class='text-lg font-semibold'>최근 글</h2>
                        <a
                            href='/'
                            class='text-muted-foreground hover:text-foreground text-sm hover:underline'
                        >
                            전체 보기 →
                        </a>
                    </div>
                    <EntryGrid entries={posts} basePath='/article' />
                </div>
            )
        }
    </section>
</BaseLayout>
